<template name="header">
<nav class="navbar navbar-dark bg-dark navbar-expand">
  <button class="navbar-toggler order-2" type="button" data-toggle="collapse" data-target="#navbar-list-9" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <a class="navbar-brand" href="/">
    <img src="/images/logo.svg" alt="logo" class="logo d-inline-block align-top">
  </a>
  <div class="collapse navbar-collapse justify-content-start w-100 order-3" id="navbar-list-9">
    {{#if currentUser}}
    {{#if isBoth}}
    <ul class="nav nav-pills">
      <li class="nav-item">
        <a class="nav-link disabled text-lightgray">Navegar como:</a>
      </li>
      <li class="nav-item">
        <a class="nav-link {{getActiveCrew}}" href="#" id="viewAsCrew">Crew</a>
      </li>
      <li class="nav-item">
        <a class="nav-link {{getActiveCast}}" href="#" id="viewAsCast">Cast</a>
      </li>
      <li class="nav-item">
        <a class="border-md-right">&nbsp;</a>
      </li>
    </ul>
    {{/if}}
    
    {{/if}}
  </div>
  {{#if currentUser}}
  <div class="collapse navbar-collapse justify-content-end w-100 order-3" id="navbar-list-9">
      
      <ul class="navbar-nav">
        {{>messageIcon}}
        {{>notifications}}

        <li class="nav-item">
          <a class="nav-link" href="/peopleList">Descubre</a>
        </li>
        <li class="nav-item">
          <a class="nav-link logout" href="#">Salir</a>
        </li>
      </ul>
      <ul class="navbar-nav">
          <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            {{>profile}}
          </a>
          <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownMenuLink">
            <div class="row">
              <div class="col-lg-3">
                {{#if getProfilePicture}}
                <img src="{{getProfilePicture}}"/>
                {{else}}
                <div id="profileImageMenu">{{getInitials}}</div>
                {{/if}}    
              </div>
              <div class="col-lg-9">
                <div class="row">
                  <div class="col-lg-12"><strong>{{getName}}</strong></div>
                </div>
                {{#if viewAsCrew}}
                <div class="row">
                  <div class="col-lg-12 agreements">{{getCrewRoles}}</div>
                </div>
                {{/if}}
                {{#if viewAsCast}}
                <div class="row">
                  <div class="col-lg-12 agreements">{{getCastRoles}}</div>
                </div>
                {{/if}}
              </div>
            </div>
            <div class="row">
              <div class="col"><div class="spacer10"></div></div>
            </div>
            <div class="row">
              <div class="col text-center">
                {{#if viewAsCrew}}
                <a href="/profilePage/{{currentUser._id}}" class="text-purple"><strong>Ver perfil</strong></a>
                {{else}}
                <a href="/profilePageActor/{{currentUser._id}}" class="text-purple"><strong>Ver perfil</strong></a>
                {{/if}}
              </div>
            </div>
            <h4 class="dropdown-header">CUENTA</h4>
            {{#if viewAsCrew}}
            <a class="dropdown-item text-black" href="/editProfile/{{currentUser._id}}">Editar perfil</a>
            {{else}}
            <a class="dropdown-item text-black" href="/editProfileActor/{{currentUser._id}}">Editar perfil</a>
            {{/if}}
           
            <div class="dropdown-divider"></div>
            
            <h4 class="dropdown-header">ADMINISTRAR</h4>
            <!--Coprobar si es CREW -->
            {{#if viewAsCrew}}
              <!-- Comprobar si es Productor o Director -->
              {{#if hasTopRole}}
                <!--Puede crear proyectos y empresas-->
                <a class="dropdown-item text-black" href="/viewProjects/{{currentUser._id}}">Mis proyectos</a>
                <a class="dropdown-item text-black" href="/viewIndustries/{{currentUser._id}}">Mis empresas</a>
              <!-- No es productor ni Director -->
              {{else}}
                <!-- Comprobar si es dueño de negocio o representante -->
                {{#if hasBusinessRole}}
                <!--Puede crear empresas-->
                <a class="dropdown-item text-black" href="/viewIndustries/{{currentUser._id}}">Mis empresas</a>
                {{else}}
                <!--No es productor ni director ni dueño ni representante, puede crear portafolios-->
                <a class="dropdown-item text-black" href="/viewProjects/{{currentUser._id}}">Mi portafolio</a>
                {{/if}}
              {{/if}}
            {{else}}
                <!--Es CAST, solo puede crear empresas-->
                <a class="dropdown-item text-black" href="/viewIndustries/{{currentUser._id}}">Mis empresas</a>
            {{/if}}
            

            
            <a class="dropdown-item text-black" href="/mediaEditorObject/{{currentUser._id}}/crew/{{currentUser._id}}/global">Mis imágenes</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item text-black logout" href="#">Salir</a>
            <!--
            <h4 class="dropdown-header">HERRAMIENTAS</h4>
            <a class="dropdown-item text-black" href="/jobs">Bolsa de trabajo</a>
            <a class="dropdown-item text-black" href="/blog">Blog</a> -->
          </div>
        </li>   
      </ul>    
  </div>
  {{else}}
  <div class="collapse navbar-collapse justify-content-end w-100 order-3" id="navbar-list-9">
    <ul class="navbar-nav">
      <!--
      <li class="nav-item">
        <a class="nav-link" href="/peopleList">Descubre</a>
      </li>-->
      <li class="nav-item">
        <a class="nav-link" href="/login">Entrar</a>
      </li>
      <li class="nav-item">
          <a class="nav-link" href="/peopleList">Descubre</a>
        </li>
    </ul>
  </div>
  {{/if}}
</nav>


</template>



<template name="profile">
{{#if loggingIn}}
  <p>Loggin in...</p>
{{else}}
  {{#if currentUser}}  
    {{#if getProfilePicture}}   
      <li class="nav-item vcenter">
        <a href="/profilePage/{{currentUser._id}}" class="text-button"><img src="{{getProfilePicture}}"/></a>
      </li>
   {{else}}
      <li class="nav-item vcenter">
        <a href="/profilePage/{{currentUser._id}}" class="text-button"><img src="/images/no-profile.jpg" id="profileImageMenu" class="img-round" /></a>
      </li>      
   {{/if}}
  
  {{/if}}
{{/if}}

</template>




